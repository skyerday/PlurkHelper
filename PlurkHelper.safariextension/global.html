<html>
<body>
<script>
	function performMessage(event) {
		if (event.name === "fetch") {
			console.log('fetch');
			event.target.page.dispatchMessage("mutekeyword", safari.extension.settings.mutekeyword);
		} else if (event.name === "update") {
		 	console.log('update key: ' + event.message);
		 	safari.extension.settings.mutekeyword = event.message;
		}
	}

	safari.application.addEventListener("message", performMessage, false);
</script>
</body>
</html>